(function(){var e,t=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++){if(t in this&&this[t]===e)return t}return-1};Object.size=function(e){var t,n,r;r=0;n=0;for(t in e){r++}return r};window.DocxGen=e=function(){function n(e,t){this.templateVars=t!=null?t:{};this.files={};this.templatedFiles=["word/document.xml","word/footer1.xml","word/footer2.xml","word/footer3.xml","word/header1.xml","word/header2.xml","word/header3.xml"];if(typeof e==="string"){this.load(e)}}var e;e=["gif","jpeg","jpg","emf","png"];n.prototype.load=function(e){var t;t=new JSZip(e);return this.files=t.files};n.prototype.getImageList=function(){var n,r,i,s;s=/[^.]*\.([^.]*)/;r=[];for(i in this.files){n=i.replace(s,"$1");if(t.call(e,n)>=0){r.push({path:i,files:this.files[i]})}}return r};n.prototype.setImage=function(e,t){return this.files[e].data=t};n.prototype.setTemplateVars=function(e){return this.templateVars=e};n.prototype.regexTest=function(e,t){var n,r,i,s,o,u,a,f,l,c;o=t;for(r=l=0,c=e.length;l<c;r=++l){a=e[r];while(o.match(a.regex)){console.log("rule"+r+("-->"+a.regex));s=a.regex.exec(o);n=0;f=a.replacement.length;u="";while(n<=f){if(a.replacement.charAt(n)==="$"){n++;i=parseInt(a.replacement.charAt(n));u+=s[i]}else if(a.replacement.charAt(n)==="#"){n++;i=parseInt(a.replacement.charAt(n));u+=this.templateVars[s[i]]}else{u+=a.replacement.charAt(n)}n++}console.log(""+s[0]);console.log("--------->>>>>");console.log(s);console.log(u);o=o.replace(s[0],u)}}return o};n.prototype.applyTemplateVars=function(){var e,t,n,r,i,s,o;s=this.templatedFiles;o=[];for(r=0,i=s.length;r<i;r++){t=s[r];if(!(this.files[t]!=null)){continue}e=this.files[t].data;n=[{regex:/(<w:t[^>]*>)([^<>]*)\{([a-zA-Z_éèàê0-9]+)\}([^}])/,replacement:"$1$2#3$4"},{regex:/\{([^}]*?)<w:t([^>]*)>([a-zA-Z_éèàê0-9]+)\}/,replacement:"$1<w:t$2>#3"},{regex:/\{((?:.(?!<w:t))*)><w:t([^>]*)>([a-zA-Z_éèàê0-9]+)((?:.(?!<w:t))*)><w:t([^>]*)>\}/,replacement:'$1><w:t$2>#3$4><w:t xml:space="preserve">'}];o.push(this.files[t].data=this.regexTest(n,e))}return o};n.prototype.output=function(e){var t,n,r,i,s,o;if(e==null){e=true}s=new JSZip;t=function(){return document.location.href="data:application/vnd.openxmlformats-officedocument.wordprocessingml.document;base64,"+i};for(r in this.files){n=this.files[r];if(n.name.slice(-1)!=="/"){if((o=n.name.slice(-4))===".png"||o===".emf"||o===".jpg"||o==="jpeg"){s.file(n.name,n.data,n.options)}else{s.file(n.name,n.data)}}}i=s.generate();if(e===true){t()}return i};n.prototype.download=function(e,t,n){var r;if(n==null){n="default.docx"}r=this.output(false);return Downloadify.create("downloadify",{filename:function(){return n},data:function(){return r},onCancel:function(){return alert("You have cancelled the saving of this file.")},onError:function(){return alert("You must put something in the File Contents or there will be nothing to save!")},swf:e,downloadImage:t,width:100,height:30,transparent:true,append:false,dataType:"base64"})};return n}()}).call(this)